<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ConnectU | Community & Housing</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="icon" href="./favicon.ico" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <style>
      body {
        background:
          radial-gradient(1200px 600px at 10% 10%, #7b61ff22, transparent),
          radial-gradient(900px 500px at 90% 90%, #34d39922, transparent),
          linear-gradient(180deg, #0f172a 0%, #0b1220 100%);
        color: #e6eef8;
        font-family:
          "Inter",
          system-ui,
          -apple-system,
          "Segoe UI",
          Roboto,
          "Helvetica Neue",
          Arial,
          sans-serif;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .fullscreen-tabs {
        flex: 1;
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        position: relative;
        z-index: 1;
      }

      .community-header {
        background: linear-gradient(
          180deg,
          rgba(15, 23, 42, 0.98),
          rgba(11, 18, 32, 0.99)
        );
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        padding: 1.5rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        backdrop-filter: blur(16px);
        position: relative;
        z-index: 2;
      }

      .community-title {
        font-size: 2rem;
        font-weight: 900;
        letter-spacing: 2px;
        color: #fff;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .back-btn {
        background: linear-gradient(90deg, #8b5cf6, #06b6d4);
        color: #021124;
        border: none;
        padding: 0.75rem 1.25rem;
        border-radius: 10px;
        font-weight: 700;
        cursor: pointer;
        font-size: 0.95rem;
        transition:
          transform 0.15s ease,
          box-shadow 0.15s ease;
        position: static;
        margin-left: 1rem;
      }
      .back-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 36px rgba(2, 6, 23, 0.35);
      }

      .tab-header {
        display: flex;
        gap: 0.5rem;
        padding: 1rem 2rem;
        background: rgba(15, 23, 42, 0.98);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        overflow-x: auto;
        backdrop-filter: blur(16px);
        position: relative;
        z-index: 2;
      }

      .tab-header button {
        padding: 0.65rem 1rem;
        background: rgba(15, 23, 42, 0.85);
        color: #e6eef8;
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 0.9rem;
        white-space: nowrap;
        transition: all 0.25s ease;
        flex: 1;
        backdrop-filter: blur(8px);
      }

      .tab-header button:hover {
        background: rgba(15, 23, 42, 0.92);
        border-color: rgba(255, 255, 255, 0.25);
        color: #fff;
      }

      .tab-header button.active {
        background: linear-gradient(90deg, #8b5cf6, #06b6d4);
        color: #021124;
        border-color: transparent;
      }

      .tab-content {
        flex: 1;
        overflow-y: auto;
        padding: 2.5rem 2rem 2rem 2rem;
        background: rgba(15, 23, 42, 0.95);
        animation: fadeIn 0.3s;
        position: relative;
        z-index: 1;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: none;
        }
      }

      .feature-list {
        color: #e6eef8;
        font-size: 1.08rem;
        line-height: 1.7;
        margin-top: 1.2rem;
      }
      .feature-list strong {
        color: #fff;
        font-weight: 700;
      }

      #heatMapContainer {
        width: 100%;
        height: 500px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 4px 32px rgba(0, 0, 0, 0.4);
        margin: 1.5rem 0;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }

      .university-label {
        color: #94a3b8;
        font-size: 0.95rem;
        text-align: center;
        margin-bottom: 0.5rem;
      }

      .housing-filters {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
      }

      .housing-filters select,
      .housing-filters input {
        padding: 0.65rem 1rem;
        background: rgba(255, 255, 255, 0.06);
        color: #cbd5e1;
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        font-size: 0.9rem;
        font-family: inherit;
      }

      .housing-filters select:focus,
      .housing-filters input:focus {
        outline: none;
        background: rgba(255, 255, 255, 0.1);
        border-color: #8b5cf6;
      }

      .budget-section {
        margin-bottom: 2rem;
      }

      .budget-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid rgba(139, 92, 246, 0.3);
      }

      .budget-icon {
        font-size: 1.5rem;
      }

      .budget-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: #fff;
      }

      .budget-range {
        font-size: 0.9rem;
        color: #94a3b8;
      }

      .listings-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .listing-card {
        background: linear-gradient(
          135deg,
          rgba(99, 102, 241, 0.1),
          rgba(6, 182, 212, 0.05)
        );
        border: 1px solid rgba(99, 102, 241, 0.2);
        border-radius: 12px;
        padding: 1.25rem;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .listing-card:hover {
        transform: translateY(-4px);
        border-color: rgba(139, 92, 246, 0.5);
        box-shadow: 0 12px 24px rgba(139, 92, 246, 0.2);
        background: linear-gradient(
          135deg,
          rgba(139, 92, 246, 0.15),
          rgba(6, 182, 212, 0.1)
        );
      }

      .listing-price {
        font-size: 1.4rem;
        font-weight: 800;
        color: #10b981;
        margin-bottom: 0.5rem;
      }

      .listing-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #fff;
        margin-bottom: 0.5rem;
      }

      .listing-location {
        font-size: 0.9rem;
        color: #94a3b8;
        margin-bottom: 0.75rem;
      }

      .listing-details {
        display: flex;
        gap: 1rem;
        margin-bottom: 0.75rem;
        font-size: 0.9rem;
        color: #cbd5e1;
      }

      .listing-detail-item {
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .listing-amenities {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-top: 0.75rem;
      }

      .amenity-tag {
        background: rgba(139, 92, 246, 0.2);
        color: #a78bfa;
        padding: 0.25rem 0.65rem;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .no-listings {
        padding: 2rem;
        text-align: center;
        color: #94a3b8;
        font-size: 1rem;
      }

      @media (max-width: 600px) {
        .tab-content {
          padding: 1.2rem 0.5rem;
        }
        .tab-header button {
          font-size: 1rem;
        }
        .listings-grid {
          grid-template-columns: 1fr;
        }
        .housing-filters {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="fullscreen-tabs">
      <div class="community-header">
        <h1 class="community-title">COMMUNITY</h1>
        <a href="./index.html" class="cta btn-secondary back-btn">‚Üê Home</a>
      </div>
      <div class="tab-header" id="tabHeader">
        <button class="active" data-tab="heatmap">Campus Heat Map</button>
        <button data-tab="housing">Housing Marketplace</button>
        <button data-tab="roommate">Roommate Finder</button>
        <button data-tab="community">Community Events</button>
        <button data-tab="resources">Local Resources</button>
      </div>
      <div class="tab-content" id="tabContent">
        <!-- Tab content will be injected here -->
      </div>
    </div>
    <script type="module">
      import { getUniversityCoords } from "./js/university-data.js";

      const tabData = {
        heatmap: `
        <h2> Campus Heat Map ‚Äî Live Activity Visualization</h2>
        <div class="university-label" id="universityLabel"></div>
        <div id="heatMapContainer"></div>
        <p style="margin-top: 1rem; color: #94a3b8; font-size: 0.95rem; text-align: center;">Real-time campus activity visualization ‚Äî darker/denser areas indicate higher student presence</p>
        <ul class="feature-list">
          <li><strong>Live Activity Tracking:</strong> See where students are most active on campus in real time. Darker, denser color overlays indicate higher student presence and activity.</li>
          <li><strong>Event Hotspots:</strong> Identify trending locations for events, study groups, pop-up markets, and social gatherings. Discover new spots based on community activity.</li>
          <li><strong>Time-Based Insights:</strong> View activity patterns by time of day, day of week, and semester. Find the best times to visit popular locations.</li>
          <li><strong>Privacy-First Design:</strong> All location data is anonymized and aggregated to protect student privacy. No individual tracking.</li>
          <li><strong>Personalized Recommendations:</strong> Get suggestions for places to study, eat, or hang out based on your preferences and current crowd levels.</li>
        </ul>
      `,
        housing: `
        <h2> Housing Marketplace</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <button onclick="window.loadHousingListings('real')" style="padding: 1rem; background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; border-radius: 10px; font-weight: 700; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;">
            Browse Listings
          </button>
        </div>
        <div id="housingContent" style="min-height: 400px;">
          <div style="text-align: center; padding: 3rem; color: #94a3b8;">
            <p style="font-size: 1.1rem; margin-bottom: 1rem;">Click the button above to browse listings</p>
            <p style="font-size: 0.9rem;"> Real listings ‚Ä¢ Budget-friendly options ‚Ä¢ Near your campus</p>
          </div>
        </div>
      `,
        roommate: `
        <h2>Roommate Finder</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <button onclick="window.startRoommateQuiz()" style="padding: 1rem; background: #8b5cf6; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;">
            Take Quiz
          </button>
          <button onclick="window.viewRoommateMatches()" style="padding: 1rem; background: #d946ef; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;">
            View Matches
          </button>
          <button onclick="window.viewRoommateGroups()" style="padding: 1rem; background: #0891b2; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;">
            View Groups
          </button>
          <button onclick="window.viewMessages()" style="padding: 1rem; background: #6366f1; color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.95rem; cursor: pointer; transition: all 0.3s ease;">
            Messages
          </button>
        </div>
        <div id="roommateContent" style="min-height: 400px;">
          <div style="text-align: center; padding: 3rem; color: #94a3b8;">
            <p style="font-size: 1.1rem; margin-bottom: 1rem;">Find your perfect roommate match</p>
            <p style="font-size: 0.9rem;">Start with the quiz, get matched, and connect</p>
          </div>
        </div>
      `,
        community: `
        <h2>Community Events</h2>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem; margin-bottom: 3rem; max-width: 1200px;">
          <button onclick="window.viewEventCalendar()" style="padding: 2.5rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(99, 102, 241, 0.1)); border: 2px solid rgba(139, 92, 246, 0.4); color: white; border-radius: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 20px 40px rgba(139, 92, 246, 0.3)'; this.style.borderColor='#a78bfa'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(139, 92, 246, 0.4)'">
            <div style="font-size: 3.5rem; margin-bottom: 1.2rem;">üìÖ</div>
            <div style="font-weight: 700; margin-bottom: 0.6rem; font-size: 1.3rem;">Event Calendar</div>
            <div style="font-size: 1rem; color: rgba(255,255,255,0.85); line-height: 1.5;">Browse all upcoming events and add them to your schedule</div>
          </button>
          <button onclick="window.createEvent()" style="padding: 2.5rem; background: linear-gradient(135deg, rgba(217, 70, 239, 0.15), rgba(236, 72, 153, 0.1)); border: 2px solid rgba(217, 70, 239, 0.4); color: white; border-radius: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 20px 40px rgba(217, 70, 239, 0.3)'; this.style.borderColor='#f472b6'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(217, 70, 239, 0.4)'">
            <div style="font-size: 3.5rem; margin-bottom: 1.2rem;">‚ú®</div>
            <div style="font-weight: 700; margin-bottom: 0.6rem; font-size: 1.3rem;">Host an Event</div>
            <div style="font-size: 1rem; color: rgba(255,255,255,0.85); line-height: 1.5;">Create and promote your own event to the community</div>
          </button>
          <button onclick="window.viewEventGroups()" style="padding: 2.5rem; background: linear-gradient(135deg, rgba(8, 145, 178, 0.15), rgba(6, 182, 212, 0.1)); border: 2px solid rgba(8, 145, 178, 0.4); color: white; border-radius: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 20px 40px rgba(8, 145, 178, 0.3)'; this.style.borderColor='#22d3ee'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(8, 145, 178, 0.4)'">
            <div style="font-size: 3.5rem; margin-bottom: 1.2rem;">üë•</div>
            <div style="font-weight: 700; margin-bottom: 0.6rem; font-size: 1.3rem;">Interest Groups</div>
            <div style="font-size: 1rem; color: rgba(255,255,255,0.85); line-height: 1.5;">Find and join clubs based on your interests and hobbies</div>
          </button>
          <button onclick="window.viewRecommended()" style="padding: 2.5rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(249, 115, 22, 0.1)); border: 2px solid rgba(245, 158, 11, 0.4); color: white; border-radius: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 20px 40px rgba(245, 158, 11, 0.3)'; this.style.borderColor='#fbbf24'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(245, 158, 11, 0.4)'">
            <div style="font-size: 3.5rem; margin-bottom: 1.2rem;">üéØ</div>
            <div style="font-weight: 700; margin-bottom: 0.6rem; font-size: 1.3rem;">For You</div>
            <div style="font-size: 1rem; color: rgba(255,255,255,0.85); line-height: 1.5;">Get personalized recommendations based on your preferences</div>
          </button>
        </div>
        <div id="eventContent" style="min-height: 400px;">
          <div style="text-align: center; padding: 3rem; color: #94a3b8;">
            <p style="font-size: 1.1rem; margin-bottom: 1rem;">Browse events, create gatherings, and connect with your community</p>
            <p style="font-size: 0.9rem;">Pick a section above to get started</p>
          </div>
        </div>
      `,
        resources: `
        <h2>Local Resources</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
          <div onclick="window.showResourceDetails('essential')" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.08)); border: 1.5px solid rgba(59, 130, 246, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(59, 130, 246, 0.25)'; this.style.borderColor='rgba(59, 130, 246, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(59, 130, 246, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #60a5fa;">01</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Essential Services</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Find comprehensive information on grocery stores, pharmacies, healthcare clinics, banks, post offices, gyms, and public transport near campus with real-time availability.</p>
          </div>

          <div onclick="window.showResourceDetails('discounts')" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(74, 222, 128, 0.08)); border: 1.5px solid rgba(34, 197, 94, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(34, 197, 94, 0.25)'; this.style.borderColor='rgba(34, 197, 94, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(34, 197, 94, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #4ade80;">02</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Student Discounts</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Access an exclusive database of deals and discounts at local restaurants, retail stores, and entertainment venues. Show your student ID to redeem and save hundreds per semester.</p>
          </div>

          <div onclick="window.showResourceDetails('moving')" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(251, 191, 36, 0.08)); border: 1.5px solid rgba(245, 158, 11, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(245, 158, 11, 0.25)'; this.style.borderColor='rgba(245, 158, 11, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(245, 158, 11, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #fbbf24;">03</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Moving Guides</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Get detailed tips, checklists, and video tutorials for moving in/out and setting up utilities. Download printable guides and access a comprehensive moving day checklist.</p>
          </div>

          <div onclick="window.showResourceDetails('transportation')" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(192, 132, 250, 0.08)); border: 1.5px solid rgba(168, 85, 247, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(168, 85, 247, 0.25)'; this.style.borderColor='rgba(168, 85, 247, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(168, 85, 247, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #c084fc;">04</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Transportation Hub</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">View bus routes, train schedules, bike-sharing locations, and ride-sharing options. Get real-time transit updates and plan your commute efficiently.</p>
          </div>

          <div onclick="window.showResourceDetails('favorites')" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(248, 113, 113, 0.08)); border: 1.5px solid rgba(239, 68, 68, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(239, 68, 68, 0.25)'; this.style.borderColor='rgba(239, 68, 68, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(239, 68, 68, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #f87171;">05</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Local Favorites</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Discover hidden gems and student-recommended spots for food, coffee, study spaces, and entertainment. Find community favorites based on authentic student reviews.</p>
          </div>

          <div onclick="window.showResourceDetails('info')" style="background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(34, 211, 238, 0.08)); border: 1.5px solid rgba(14, 165, 233, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(14, 165, 233, 0.25)'; this.style.borderColor='rgba(14, 165, 233, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(14, 165, 233, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #22d3ee;">INFO</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">What's This About</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">ConnectU's Local Resources is your complete guide to navigating student life around campus. Find everything you need in one place‚Äîfrom essential services to hidden local gems.</p>
          </div>
        </div>
      `,
        resources: `
        <h2>Local Resources</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
          <div onclick="window.showResourceDetails('essential')" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.08)); border: 1.5px solid rgba(59, 130, 246, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(59, 130, 246, 0.25)'; this.style.borderColor='rgba(59, 130, 246, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(59, 130, 246, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #60a5fa;">01</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Essential Services</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Find comprehensive information on grocery stores, pharmacies, healthcare clinics, banks, post offices, gyms, and public transport near campus with real-time availability.</p>
          </div>

          <div onclick="window.showResourceDetails('discounts')" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(74, 222, 128, 0.08)); border: 1.5px solid rgba(34, 197, 94, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(34, 197, 94, 0.25)'; this.style.borderColor='rgba(34, 197, 94, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(34, 197, 94, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #4ade80;">02</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Student Discounts</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Access an exclusive database of deals and discounts at local restaurants, retail stores, and entertainment venues. Show your student ID to redeem and save hundreds per semester.</p>
          </div>

          <div onclick="window.showResourceDetails('moving')" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(251, 191, 36, 0.08)); border: 1.5px solid rgba(245, 158, 11, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(245, 158, 11, 0.25)'; this.style.borderColor='rgba(245, 158, 11, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(245, 158, 11, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #fbbf24;">03</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Moving Guides</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Get detailed tips, checklists, and video tutorials for moving in/out and setting up utilities. Download printable guides and access a comprehensive moving day checklist.</p>
          </div>

          <div onclick="window.showResourceDetails('transportation')" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(192, 132, 250, 0.08)); border: 1.5px solid rgba(168, 85, 247, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(168, 85, 247, 0.25)'; this.style.borderColor='rgba(168, 85, 247, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(168, 85, 247, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #c084fc;">04</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Transportation Hub</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">View bus routes, train schedules, bike-sharing locations, and ride-sharing options. Get real-time transit updates and plan your commute efficiently.</p>
          </div>

          <div onclick="window.showResourceDetails('favorites')" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(248, 113, 113, 0.08)); border: 1.5px solid rgba(239, 68, 68, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(239, 68, 68, 0.25)'; this.style.borderColor='rgba(239, 68, 68, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(239, 68, 68, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #f87171;">05</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">Local Favorites</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">Discover hidden gems and student-recommended spots for food, coffee, study spaces, and entertainment. Find community favorites based on authentic student reviews.</p>
          </div>

          <div onclick="window.showResourceDetails('info')" style="background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(34, 211, 238, 0.08)); border: 1.5px solid rgba(14, 165, 233, 0.3); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s ease;\" onmouseover="this.style.transform='translateY(-8px)'; this.style.boxShadow='0 16px 32px rgba(14, 165, 233, 0.25)'; this.style.borderColor='rgba(14, 165, 233, 0.6)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'; this.style.borderColor='rgba(14, 165, 233, 0.3)'">
            <div style="font-size: 2.5rem; margin-bottom: 1rem; font-weight: 700; color: #22d3ee;">INFO</div>
            <h3 style="color: #fff; margin: 0 0 1rem 0; font-size: 1.3rem;">What's This About</h3>
            <p style="color: #cbd5e1; margin: 0; line-height: 1.6; font-size: 0.95rem;">ConnectU's Local Resources is your complete guide to navigating student life around campus. Find everything you need in one place‚Äîfrom essential services to hidden local gems.</p>
          </div>
        </div>
      `,
      };

      const tabHeader = document.getElementById("tabHeader");
      const tabContent = document.getElementById("tabContent");
      let activeTab = "heatmap";

      /**
       * Generate realistic heatmap data points around campus coordinates
       */
      function generateCampusHeatData(centerLat, centerLng) {
        const data = [];
        const hotspots = [
          { offset: [0, 0], intensity: 0.9, name: "Main Library" },
          { offset: [0.005, 0.005], intensity: 0.7, name: "Student Center" },
          { offset: [-0.004, 0.006], intensity: 0.65, name: "Dining Hall" },
          { offset: [0.006, -0.003], intensity: 0.6, name: "Sports Complex" },
          {
            offset: [-0.003, -0.005],
            intensity: 0.55,
            name: "Science Building",
          },
        ];

        // Add hotspot clusters
        hotspots.forEach((spot) => {
          const lat = centerLat + spot.offset[0];
          const lng = centerLng + spot.offset[1];

          // Generate multiple points around each hotspot
          for (let i = 0; i < 15; i++) {
            const variance = 0.002;
            data.push([
              lat + (Math.random() - 0.5) * variance,
              lng + (Math.random() - 0.5) * variance,
              spot.intensity + (Math.random() - 0.5) * 0.2,
            ]);
          }
        });

        // Add scattered activity points
        for (let i = 0; i < 20; i++) {
          data.push([
            centerLat + (Math.random() - 0.5) * 0.015,
            centerLng + (Math.random() - 0.5) * 0.015,
            Math.random() * 0.5,
          ]);
        }

        return data;
      }

      /**
       * Initialize heatmap with university-specific coordinates
       */
      function initializeHeatMap() {
        // Get stored university
        const universityName = localStorage.getItem("connectu_university");
        let coords = { lat: 43.6629, lng: -79.3957 }; // Default to UofT
        let displayName = "University of Toronto";

        if (universityName) {
          const univCoords = getUniversityCoords(universityName);
          if (univCoords) {
            coords = { lat: univCoords.lat, lng: univCoords.lng };
            displayName = univCoords.name;
          }
        }

        // Update university label
        const universityLabel = document.getElementById("universityLabel");
        if (universityLabel) {
          universityLabel.textContent = `üìç ${displayName}`;
        }

        // Initialize map
        const map = L.map("heatMapContainer").setView(
          [coords.lat, coords.lng],
          15
        );

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: "¬© OpenStreetMap contributors",
          maxZoom: 19,
        }).addTo(map);

        // Generate realistic heatmap data around campus
        const heatData = generateCampusHeatData(coords.lat, coords.lng);

        // Add heatmap layer
        L.heatLayer(heatData, {
          radius: 25,
          blur: 15,
          maxZoom: 1,
          gradient: { 0.4: "blue", 0.65: "cyan", 0.8: "yellow", 1.0: "red" },
        }).addTo(map);

        // Add campus marker
        L.marker([coords.lat, coords.lng], {
          title: displayName,
        })
          .addTo(map)
          .bindPopup(`<b>${displayName}</b><br>Active Study Zone`)
          .openPopup();
      }

      function renderTab(tab) {
        tabContent.innerHTML = tabData[tab];
        [...tabHeader.children].forEach((btn) =>
          btn.classList.toggle("active", btn.dataset.tab === tab)
        );
        activeTab = tab;

        // Initialize Leaflet map if heatmap tab is active
        if (tab === "heatmap") {
          setTimeout(() => {
            const mapContainer = document.getElementById("heatMapContainer");
            if (mapContainer && !mapContainer._leaflet_id) {
              initializeHeatMap();
            }
          }, 100);
        }
      }

      tabHeader.addEventListener("click", (e) => {
        if (e.target.tagName === "BUTTON") {
          const tab = e.target.dataset.tab;
          if (tab && tab !== activeTab) {
            renderTab(tab);
          }
        }
      });

      // Housing Marketplace - Fresh Implementation with Filters
      const housingListings = [
        // University of Toronto
        {
          title: "Cozy Studio",
          price: 650,
          bedrooms: 1,
          type: "Room",
          amenities: "WiFi, Furnished, Shared",
          university: "University of Toronto",
          address: "45 Bloor St W",
          budget: "budget",
        },
        {
          title: "Shared 2BR Apartment",
          price: 850,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Kitchen, Laundry, Parking",
          university: "University of Toronto",
          address: "123 Dundas St W",
          budget: "moderate",
        },
        {
          title: "Modern 1BR Loft",
          price: 1050,
          bedrooms: 1,
          type: "Apartment",
          amenities: "AC, Gym, Balcony",
          university: "University of Toronto",
          address: "567 King St W",
          budget: "moderate",
        },
        {
          title: "3BR House",
          price: 1450,
          bedrooms: 3,
          type: "House",
          amenities: "Yard, Garage, Pet OK",
          university: "University of Toronto",
          address: "890 Queen St E",
          budget: "premium",
        },
        {
          title: "Premium 2BR Condo",
          price: 1650,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Pool, Gym, Concierge",
          university: "University of Toronto",
          address: "234 Yonge St",
          budget: "premium",
        },
        {
          title: "Student Room",
          price: 550,
          bedrooms: 1,
          type: "Room",
          amenities: "Furnished, WiFi, Utilities Inc.",
          university: "University of Toronto",
          address: "78 College St",
          budget: "budget",
        },

        // University of Waterloo
        {
          title: "Basement Bachelor",
          price: 600,
          bedrooms: 1,
          type: "Room",
          amenities: "Independent Entry, WiFi",
          university: "University of Waterloo",
          address: "200 University Ave W",
          budget: "budget",
        },
        {
          title: "Shared 2BR",
          price: 800,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Full Kitchen, Washer/Dryer, Close to Campus",
          university: "University of Waterloo",
          address: "450 Columbia St",
          budget: "moderate",
        },
        {
          title: "1BR Suite",
          price: 900,
          bedrooms: 1,
          type: "Apartment",
          amenities: "Private Bathroom, Furnished",
          university: "University of Waterloo",
          address: "175 King St S",
          budget: "moderate",
        },
        {
          title: "House for 4",
          price: 1250,
          bedrooms: 4,
          type: "House",
          amenities: "Backyard, Parking, Pet Friendly",
          university: "University of Waterloo",
          address: "380 Bridgeport Rd",
          budget: "premium",
        },
        {
          title: "Downtown Apartment",
          price: 1000,
          bedrooms: 1,
          type: "Apartment",
          amenities: "Transit Access, Modern Kitchen",
          university: "University of Waterloo",
          address: "99 Queen St S",
          budget: "moderate",
        },
        {
          title: "Luxury Penthouse",
          price: 1800,
          bedrooms: 2,
          type: "Apartment",
          amenities: "City Views, Gym, Spa",
          university: "University of Waterloo",
          address: "500 Market St",
          budget: "premium",
        },

        // McMaster University
        {
          title: "Budget Room",
          price: 620,
          bedrooms: 1,
          type: "Room",
          amenities: "WiFi, Furnished",
          university: "McMaster University",
          address: "1280 Main St W",
          budget: "budget",
        },
        {
          title: "2BR Shared",
          price: 780,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Kitchen, Laundry, Utilities",
          university: "McMaster University",
          address: "150 Duke St",
          budget: "moderate",
        },
        {
          title: "1BR Cozy",
          price: 920,
          bedrooms: 1,
          type: "Apartment",
          amenities: "Furnished, AC, WiFi",
          university: "McMaster University",
          address: "345 King St E",
          budget: "moderate",
        },
        {
          title: "3BR House",
          price: 1380,
          bedrooms: 3,
          type: "House",
          amenities: "Garden, Garage, Pet OK",
          university: "McMaster University",
          address: "567 Mountain Ave",
          budget: "premium",
        },
        {
          title: "Premium Condo",
          price: 1620,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Pool, Concierge, Gym",
          university: "McMaster University",
          address: "200 Cannon St E",
          budget: "premium",
        },
        {
          title: "Student Basement",
          price: 580,
          bedrooms: 1,
          type: "Room",
          amenities: "Separate Entry, WiFi",
          university: "McMaster University",
          address: "100 York Blvd",
          budget: "budget",
        },

        // Western University
        {
          title: "Dorm-Style Room",
          price: 640,
          bedrooms: 1,
          type: "Room",
          amenities: "WiFi, Furnished, Utilities",
          university: "Western University",
          address: "1151 Richmond St N",
          budget: "budget",
        },
        {
          title: "Shared 2BR",
          price: 820,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Full Kitchen, Laundry, Parking",
          university: "Western University",
          address: "280 Dundas St",
          budget: "moderate",
        },
        {
          title: "1BR Modern",
          price: 950,
          bedrooms: 1,
          type: "Apartment",
          amenities: "AC, Balcony, Gym",
          university: "Western University",
          address: "450 Proudfoot Ln",
          budget: "moderate",
        },
        {
          title: "House for Students",
          price: 1300,
          bedrooms: 4,
          type: "House",
          amenities: "Large Yard, Garage",
          university: "Western University",
          address: "123 Colborne St",
          budget: "premium",
        },
        {
          title: "Luxury 2BR",
          price: 1700,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Premium Finishes, Concierge",
          university: "Western University",
          address: "567 Oxford St",
          budget: "premium",
        },
        {
          title: "Shared Room",
          price: 570,
          bedrooms: 1,
          type: "Room",
          amenities: "WiFi, Furnished",
          university: "Western University",
          address: "90 Windermere Ave",
          budget: "budget",
        },

        // York University
        {
          title: "Budget Studio",
          price: 610,
          bedrooms: 1,
          type: "Room",
          amenities: "WiFi, Furnished",
          university: "York University",
          address: "4700 Keele St",
          budget: "budget",
        },
        {
          title: "2BR Apartment",
          price: 790,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Kitchen, Laundry, TTC Access",
          university: "York University",
          address: "100 University Dr",
          budget: "moderate",
        },
        {
          title: "1BR Apartment",
          price: 900,
          bedrooms: 1,
          type: "Apartment",
          amenities: "Furnished, Utilities Inc.",
          university: "York University",
          address: "200 Steeles Ave W",
          budget: "moderate",
        },
        {
          title: "3BR House",
          price: 1320,
          bedrooms: 3,
          type: "House",
          amenities: "Backyard, Parking",
          university: "York University",
          address: "300 Sentinel Rd",
          budget: "premium",
        },
        {
          title: "Premium Condo",
          price: 1680,
          bedrooms: 2,
          type: "Apartment",
          amenities: "Gym, Pool, Concierge",
          university: "York University",
          address: "500 Murray Ross Pkwy",
          budget: "premium",
        },
        {
          title: "Shared Room",
          price: 590,
          bedrooms: 1,
          type: "Room",
          amenities: "Furnished, WiFi",
          university: "York University",
          address: "50 Assiniboine Rd",
          budget: "budget",
        },
      ];

      window.loadHousingListings = function (type) {
        const container = document.getElementById("housingContent");

        // Get user's university from sessionStorage
        const user = JSON.parse(
          sessionStorage.getItem("connectu_user") || "{}"
        );
        const userUniversity = user.school || null;

        // Filter listings by university if user has one selected
        let filteredListings = userUniversity
          ? housingListings.filter((l) => l.university === userUniversity)
          : housingListings;

        // Build filter UI and listings
        let html = `
        <div style="margin-bottom: 2rem;">
          <h3 style="color: #cbd5e1; margin-bottom: 1rem;">Filter Listings</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
            <div>
              <label style="display: block; font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.5rem;">Budget</label>
              <select id="budgetFilter" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; cursor: pointer;" onchange="window.applyHousingFilters()">
                <option value="">All Budgets</option>
                <option value="budget">Budget ($500-$800)</option>
                <option value="moderate">Moderate ($800-$1200)</option>
                <option value="premium">Premium ($1200+)</option>
              </select>
            </div>
            <div>
              <label style="display: block; font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.5rem;">Housing Style</label>
              <select id="typeFilter" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; cursor: pointer;" onchange="window.applyHousingFilters()">
                <option value="">All Types</option>
                <option value="Room">Room</option>
                <option value="Apartment">Apartment</option>
                <option value="House">House</option>
              </select>
            </div>
          </div>
        </div>
        
        <div id="listingsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;"></div>
      `;

        container.innerHTML = html;

        // Store listings for filtering
        window.allHousingListings = filteredListings;
        window.applyHousingFilters();
      };

      window.applyHousingFilters = function () {
        const budgetFilter =
          document.getElementById("budgetFilter")?.value || "";
        const typeFilter = document.getElementById("typeFilter")?.value || "";
        const grid = document.getElementById("listingsGrid");

        let filtered = window.allHousingListings || [];

        if (budgetFilter) {
          filtered = filtered.filter((l) => l.budget === budgetFilter);
        }
        if (typeFilter) {
          filtered = filtered.filter((l) => l.type === typeFilter);
        }

        let html = "";
        filtered.forEach((listing) => {
          html += `
          <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 12px 24px rgba(139, 92, 246, 0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 1.5rem; font-weight: 800; color: #10b981; margin-bottom: 0.5rem;">$${listing.price}/mo</div>
            <div style="font-size: 1.1rem; font-weight: 700; color: #fff; margin-bottom: 0.2rem;">${listing.title}</div>
            <div style="font-size: 0.85rem; color: #cbd5e1; margin-bottom: 0.3rem;">üìç ${listing.address}</div>
            <div style="font-size: 0.85rem; color: #94a3b8; margin-bottom: 1rem;">üè´ ${listing.university}</div>
            <div style="font-size: 0.9rem; color: #cbd5e1; margin-bottom: 1rem;">
              <span style="display: inline-block; margin-right: 1rem;">üõèÔ∏è ${listing.bedrooms} bed${listing.bedrooms > 1 ? "s" : ""}</span>
              <span>üè† ${listing.type}</span>
            </div>
            <div style="font-size: 0.85rem; color: #a7c1d9; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
              <strong>Amenities:</strong><br>${listing.amenities}
            </div>
          </div>
        `;
        });

        if (!html) {
          html =
            '<div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: #94a3b8;">No listings match your filters</div>';
        }

        grid.innerHTML = html;
      };

      // Roommate Finder Database & Functions
      const roommateDatabase = [
        {
          id: 1,
          name: "Alex Chen",
          major: "Computer Science",
          year: "Year 3",
          bio: "Night owl programmer who loves coding projects and gaming",
          sleepSchedule: "night",
          cleanliness: "moderate",
          studyHabits: "focused",
          socialPreference: "moderate",
          petAllergy: "none",
          interests: "Coding, Gaming, Anime",
          verified: true,
          initial: "AC",
        },
        {
          id: 2,
          name: "Jordan Smith",
          major: "Business",
          year: "Year 2",
          bio: "Social butterfly looking for a fun, outgoing roommate",
          sleepSchedule: "early",
          cleanliness: "high",
          studyHabits: "flexible",
          socialPreference: "high",
          petAllergy: "cats",
          interests: "Networking, Events, Travel",
          verified: true,
          initial: "JS",
        },
        {
          id: 3,
          name: "Maya Patel",
          major: "Engineering",
          year: "Year 4",
          bio: "Quiet, focused student seeking like-minded roommate",
          sleepSchedule: "early",
          cleanliness: "high",
          studyHabits: "very focused",
          socialPreference: "low",
          petAllergy: "none",
          interests: "Research, Reading, Yoga",
          verified: true,
          initial: "MP",
        },
        {
          id: 4,
          name: "Chris Williams",
          major: "Music",
          year: "Year 3",
          bio: "Creative musician open to sharing music projects",
          sleepSchedule: "variable",
          cleanliness: "moderate",
          studyHabits: "creative",
          socialPreference: "moderate",
          petAllergy: "dogs",
          interests: "Music, Art, Film",
          verified: true,
          initial: "CW",
        },
        {
          id: 5,
          name: "Sam Rodriguez",
          major: "Biology",
          year: "Year 2",
          bio: "Health-conscious student who loves fitness and cooking",
          sleepSchedule: "early",
          cleanliness: "high",
          studyHabits: "moderate",
          socialPreference: "moderate",
          petAllergy: "none",
          interests: "Fitness, Cooking, Hiking",
          verified: true,
          initial: "SR",
        },
        {
          id: 6,
          name: "Taylor Kim",
          major: "Psychology",
          year: "Year 3",
          bio: "Empathetic listener interested in wellness and community",
          sleepSchedule: "moderate",
          cleanliness: "high",
          studyHabits: "moderate",
          socialPreference: "high",
          petAllergy: "none",
          interests: "Wellness, Volunteering, Coffee",
          verified: true,
          initial: "TK",
        },
      ];

      const roommateGroups = [
        {
          id: 1,
          name: "4BR House - Downtown",
          size: "3/4",
          budget: "$400-450/month",
          members: ["Alex", "Jordan", "Sam"],
          interests: "Social, Close to Campus",
          created: "2 weeks ago",
        },
        {
          id: 2,
          name: "2BR Apt - Quiet Study",
          size: "1/2",
          budget: "$600/month",
          members: ["Maya"],
          interests: "Focused, Peaceful",
          created: "3 days ago",
        },
        {
          id: 3,
          name: "3BR House - Creative",
          size: "2/3",
          budget: "$500/month",
          members: ["Chris", "Taylor"],
          interests: "Artistic, Supportive",
          created: "1 week ago",
        },
      ];

      window.startRoommateQuiz = function () {
        const container = document.getElementById("roommateContent");

        const quizHTML = `
        <div style="max-width: 700px; margin: 0 auto;">
          <h3 style="color: #fff; margin-bottom: 1.5rem;">Compatibility Quiz</h3>
          
          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">1. What's your sleep schedule?</label>
            <select id="sleepSchedule" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
              <option value="">Select an option</option>
              <option value="early">Early bird (sleep by 11pm)</option>
              <option value="moderate">Moderate (sleep around 12-1am)</option>
              <option value="night">Night owl (sleep after 1am)</option>
              <option value="variable">Variable/Flexible</option>
            </select>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">2. How clean/tidy do you prefer your space?</label>
            <select id="cleanliness" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
              <option value="">Select an option</option>
              <option value="low">Relaxed (things can be messy)</option>
              <option value="moderate">Moderate (reasonably clean)</option>
              <option value="high">High (very clean and organized)</option>
            </select>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">3. How do you approach studying/work?</label>
            <select id="studyHabits" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
              <option value="">Select an option</option>
              <option value="flexible">Flexible (can study anywhere)</option>
              <option value="moderate">Moderate (need quiet sometimes)</option>
              <option value="focused">Focused (need dedicated study time)</option>
              <option value="very focused">Very focused (need strict quiet hours)</option>
            </select>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">4. How social do you prefer to be?</label>
            <select id="socialPreference" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
              <option value="">Select an option</option>
              <option value="low">Low (prefer solitude)</option>
              <option value="moderate">Moderate (occasional hangouts)</option>
              <option value="high">High (love having people over)</option>
            </select>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">5. Any pet allergies?</label>
            <select id="petAllergy" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px;">
              <option value="">Select an option</option>
              <option value="none">No allergies</option>
              <option value="cats">Cat allergy</option>
              <option value="dogs">Dog allergy</option>
              <option value="both">Both cat & dog allergies</option>
            </select>
          </div>

          <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem;">
            <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">6. Your interests/hobbies (comma-separated)</label>
            <input id="interests" type="text" placeholder="e.g. Gaming, Coding, Sports" style="width: 100%; padding: 0.5rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; box-sizing: border-box;">
          </div>

          <button onclick="window.submitQuiz()" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border: none; border-radius: 10px; font-weight: 700; font-size: 1rem; cursor: pointer;">
            Submit Quiz & Get Matches
          </button>
        </div>
      `;

        container.innerHTML = quizHTML;
      };

      window.submitQuiz = function () {
        const answers = {
          sleepSchedule: document.getElementById("sleepSchedule").value,
          cleanliness: document.getElementById("cleanliness").value,
          studyHabits: document.getElementById("studyHabits").value,
          socialPreference: document.getElementById("socialPreference").value,
          petAllergy: document.getElementById("petAllergy").value,
          interests: document.getElementById("interests").value,
        };

        if (
          !answers.sleepSchedule ||
          !answers.cleanliness ||
          !answers.studyHabits ||
          !answers.socialPreference ||
          !answers.petAllergy
        ) {
          alert("Please fill in all fields");
          return;
        }

        // Save to sessionStorage
        const user = JSON.parse(
          sessionStorage.getItem("connectu_user") || "{}"
        );
        user.roommatePreferences = answers;
        sessionStorage.setItem("connectu_user", JSON.stringify(user));

        window.viewRoommateMatches();
      };

      window.calculateCompatibility = function (userAnswers, roommate) {
        let score = 0;

        if (userAnswers.sleepSchedule === roommate.sleepSchedule) score += 25;
        else if (
          userAnswers.sleepSchedule === "moderate" ||
          roommate.sleepSchedule === "moderate" ||
          userAnswers.sleepSchedule === "variable" ||
          roommate.sleepSchedule === "variable"
        )
          score += 15;

        if (userAnswers.cleanliness === roommate.cleanliness) score += 25;
        else if (
          Math.abs(
            ["low", "moderate", "high"].indexOf(userAnswers.cleanliness) -
              ["low", "moderate", "high"].indexOf(roommate.cleanliness)
          ) === 1
        )
          score += 15;

        if (userAnswers.studyHabits === roommate.studyHabits) score += 20;
        else score += 5;

        if (userAnswers.socialPreference === roommate.socialPreference)
          score += 20;
        else score += 5;

        if (
          userAnswers.petAllergy === "none" ||
          userAnswers.petAllergy === roommate.petAllergy ||
          roommate.petAllergy === "none"
        )
          score += 10;

        return Math.min(100, score);
      };

      window.viewRoommateMatches = function () {
        const container = document.getElementById("roommateContent");
        const user = JSON.parse(
          sessionStorage.getItem("connectu_user") || "{}"
        );

        if (!user.roommatePreferences) {
          container.innerHTML =
            '<div style="text-align: center; padding: 2rem; color: #94a3b8;"><p>Please take the quiz first to get matches!</p><button onclick="window.startRoommateQuiz()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;">Take Quiz</button></div>';
          return;
        }

        let html =
          '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">';

        roommateDatabase.forEach((roommate) => {
          const compatibility = window.calculateCompatibility(
            user.roommatePreferences,
            roommate
          );
          const compatColor =
            compatibility > 75
              ? "#10b981"
              : compatibility > 50
                ? "#f59e0b"
                : "#ef4444";

          html += `
          <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; cursor: pointer;" onmouseover="this.style.boxShadow='0 12px 24px rgba(139, 92, 246, 0.3)'; this.style.transform='translateY(-5px)'" onmouseout="this.style.boxShadow='none'; this.style.transform='translateY(0)'">
            <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 0.5rem; color: white; font-weight: 700; font-size: 1.2rem;">${roommate.initial}</div>
            <div style="font-size: 1.2rem; font-weight: 700; color: #fff; margin-bottom: 0.3rem; text-align: center;">${roommate.name}</div>
            <div style="font-size: 0.85rem; color: #94a3b8; margin-bottom: 0.5rem; text-align: center;">${roommate.major} ‚Ä¢ ${roommate.year}</div>
            <div style="font-size: 0.9rem; color: #cbd5e1; margin-bottom: 1rem; font-style: italic;">"${roommate.bio}"</div>
            
            <div style="background: rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem;">
              <div style="font-size: 0.85rem; color: #94a3b8; margin-bottom: 0.5rem;">Interests: ${roommate.interests}</div>
              <div style="font-size: 0.8rem; color: #a7c1d9;">Sleep: ${roommate.sleepSchedule} ‚Ä¢ Clean: ${roommate.cleanliness}</div>
            </div>

            <div style="background: rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem; text-align: center;">
              <div style="font-size: 0.85rem; color: #cbd5e1; margin-bottom: 0.3rem;">Compatibility Score</div>
              <div style="font-size: 1.8rem; font-weight: 800; color: ${compatColor};">${compatibility}%</div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
              <button onclick="window.viewRoommateProfile(${roommate.id})" style="padding: 0.5rem; background: rgba(139, 92, 246, 0.3); color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">Profile</button>
              <button onclick="window.startChat(${roommate.id})" style="padding: 0.5rem; background: #d946ef; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">Chat</button>
            </div>
          </div>
        `;
        });

        html += "</div>";
        container.innerHTML = html;
      };

      window.viewRoommateProfile = function (roommateId) {
        const roommate = roommateDatabase.find((r) => r.id === roommateId);
        if (!roommate) return;

        const container = document.getElementById("roommateContent");
        const compatibilityDetails = {
          sleep:
            "Moderate compatibility on sleep schedules - try setting quiet hours for consideration",
          clean: "Great match! You both prefer similar cleanliness levels",
          study: "Different study styles - clear boundaries recommended",
          social: "Perfect match for social compatibility",
          pets: "No pet conflicts",
          shared: "Both interested in gaming and movies",
        };

        const html = `
        <div style="max-width: 600px; margin: 0 auto;">
          <button onclick="window.viewRoommateMatches()" style="margin-bottom: 1rem; padding: 0.5rem 1rem; background: rgba(99, 102, 241, 0.3); color: #fff; border: none; border-radius: 6px; cursor: pointer;">‚Üê Back to Matches</button>
          
          <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 2rem;">
            <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: 700; font-size: 2rem;">${roommate.initial}</div>
            <div style="font-size: 1.8rem; font-weight: 700; color: #fff; text-align: center; margin-bottom: 0.5rem;">${roommate.name}</div>
            <div style="font-size: 1rem; color: #94a3b8; text-align: center; margin-bottom: 2rem;">Verified Student | ${roommate.major} ‚Ä¢ ${roommate.year}</div>
            
            <div style="background: rgba(255, 255, 255, 0.05); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
              <p style="color: #cbd5e1; font-size: 1rem; margin: 0;">"${roommate.bio}"</p>
            </div>

            <div style="margin-bottom: 1.5rem;">
              <h4 style="color: #fff; margin-bottom: 1rem;">Lifestyle Preferences</h4>
              <div style="display: grid; gap: 0.75rem;">
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Sleep Schedule:</strong> ${roommate.sleepSchedule}
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Cleanliness:</strong> ${roommate.cleanliness}
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Study Habits:</strong> ${roommate.studyHabits}
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Social Preference:</strong> ${roommate.socialPreference}
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Pet Allergies:</strong> ${roommate.petAllergy}
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  <strong>Interests:</strong> ${roommate.interests}
                </div>
              </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
              <h4 style="color: #fff; margin-bottom: 1rem;">Compatibility Insights</h4>
              <div style="display: grid; gap: 0.75rem;">
                <div style="background: rgba(16, 185, 129, 0.1); border-left: 3px solid #10b981; padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  ${compatibilityDetails.sleep}
                </div>
                <div style="background: rgba(16, 185, 129, 0.1); border-left: 3px solid #10b981; padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  ${compatibilityDetails.clean}
                </div>
                <div style="background: rgba(59, 130, 246, 0.1); border-left: 3px solid #3b82f6; padding: 0.75rem; border-radius: 6px; color: #cbd5e1;">
                  ${compatibilityDetails.study}
                </div>
              </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <button onclick="window.startChat(${roommate.id})" style="padding: 1rem; background: #d946ef; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Send Message</button>
              <button onclick="alert('Video call feature coming soon!')" style="padding: 1rem; background: #0891b2; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Schedule Call</button>
            </div>
          </div>
        </div>
      `;

        container.innerHTML = html;
      };

      window.startChat = function (roommateId) {
        const roommate = roommateDatabase.find((r) => r.id === roommateId);
        const container = document.getElementById("roommateContent");

        const html = `
        <div style="max-width: 600px; margin: 0 auto;">
          <button onclick="window.viewRoommateMatches()" style="margin-bottom: 1rem; padding: 0.5rem 1rem; background: rgba(99, 102, 241, 0.3); color: #fff; border: none; border-radius: 6px; cursor: pointer;">‚Üê Back to Matches</button>
          
          <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem;">
            <div style="font-size: 1.3rem; font-weight: 700; color: #fff; margin-bottom: 1rem;">Chat with ${roommate.name}</div>
            
            <div id="chatMessages" style="background: rgba(15, 23, 42, 0.5); border-radius: 8px; padding: 1rem; height: 300px; overflow-y: auto; margin-bottom: 1rem; border: 1px solid rgba(99, 102, 241, 0.2);">
              <div style="text-align: center; color: #94a3b8; padding: 1rem;">No messages yet. Start the conversation!</div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr auto; gap: 0.5rem;">
              <input id="chatInput" type="text" placeholder="Type your message..." style="padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 6px; box-sizing: border-box;">
              <button onclick="window.sendChatMessage(${roommateId})" style="padding: 0.75rem 1rem; background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; border-radius: 6px; font-weight: 700; cursor: pointer;">Send</button>
            </div>

            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(99, 102, 241, 0.2);">
              <button onclick="alert('Share documents feature coming soon!')" style="padding: 0.5rem 1rem; background: rgba(59, 130, 246, 0.2); color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem; margin-right: 0.5rem;">Share Documents</button>
              <button onclick="alert('Video call feature coming soon!')" style="padding: 0.5rem 1rem; background: rgba(59, 130, 246, 0.2); color: #fff; border: none; border-radius: 6px; cursor: pointer; font-size: 0.85rem;">Video Call</button>
            </div>
          </div>
        </div>
      `;

        container.innerHTML = html;
      };

      window.sendChatMessage = function (roommateId) {
        const input = document.getElementById("chatInput");
        const message = input.value.trim();
        if (!message) return;

        const messagesDiv = document.getElementById("chatMessages");
        const messageHTML = `
        <div style="margin-bottom: 0.75rem; text-align: right;">
          <div style="display: inline-block; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; padding: 0.75rem 1rem; border-radius: 12px; max-width: 80%; word-wrap: break-word;">
            ${message}
          </div>
          <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 0.25rem;">Just now</div>
        </div>
      `;

        messagesDiv.innerHTML += messageHTML;
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
        input.value = "";
      };

      window.viewRoommateGroups = function () {
        const container = document.getElementById("roommateContent");

        let html = `
        <div style="margin-bottom: 1.5rem;">
          <button onclick="alert('Create group feature coming soon!')" style="padding: 0.75rem 1.5rem; background: #8b5cf6; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Create Group</button>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem;">
      `;

        roommateGroups.forEach((group) => {
          html += `
          <div style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(6, 182, 212, 0.05)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1.5rem; cursor: pointer;" onclick="alert('View group details coming soon!')">
            <div style="font-size: 1.2rem; font-weight: 700; color: #fff; margin-bottom: 0.5rem;">${group.name}</div>
            <div style="font-size: 0.9rem; color: #cbd5e1; margin-bottom: 1rem;">
              <div>Members: ${group.size}</div>
              <div>${group.budget}</div>
              <div>Created ${group.created}</div>
            </div>
            <div style="font-size: 0.85rem; color: #94a3b8; margin-bottom: 1rem;">
              <strong>Members:</strong> ${group.members.join(", ")}
            </div>
            <div style="font-size: 0.85rem; color: #a7c1d9;">
              <strong>Interests:</strong> ${group.interests}
            </div>
            <button onclick="event.stopPropagation(); alert('Join group feature coming soon!')" style="width: 100%; margin-top: 1rem; padding: 0.5rem; background: #8b5cf6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Join Group</button>
          </div>
        `;
        });

        html += "</div>";
        container.innerHTML = html;
      };

      window.viewMessages = function () {
        const container = document.getElementById("roommateContent");

        const html = `
        <div style="max-width: 800px; margin: 0 auto;">
          <div style="display: grid; grid-template-columns: 250px 1fr; gap: 1.5rem; min-height: 500px;">
            <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1rem;">
              <h3 style="color: #fff; margin-bottom: 1rem; font-size: 1rem;">Conversations</h3>
              ${roommateDatabase
                .slice(0, 3)
                .map(
                  (rm) => `
                <div onclick="window.startChat(${rm.id})" style="padding: 0.75rem; background: rgba(99, 102, 241, 0.2); border-radius: 6px; margin-bottom: 0.5rem; cursor: pointer; color: #cbd5e1; border-left: 3px solid #3b82f6;">
                  ${rm.name}
                  <div style="font-size: 0.75rem; color: #94a3b8;">Online now</div>
                </div>
              `
                )
                .join("")}
            </div>
            
            <div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 12px; padding: 1rem;">
              <div style="text-align: center; color: #94a3b8; padding: 5rem 1rem;">
                <p>Select a conversation to start messaging</p>
              </div>
            </div>
          </div>
        </div>
      `;

        container.innerHTML = html;
      };

      // Community Events Functions
      const upcomingEvents = [
        {
          id: 1,
          title: "Game Night at the Quad",
          category: "Social",
          date: "Nov 20",
          time: "7:00 PM",
          location: "Student Center",
          attendees: 24,
          type: "Board Games",
        },
        {
          id: 2,
          title: "Jazz Concert - Campus Tour",
          category: "Cultural",
          date: "Nov 22",
          time: "8:00 PM",
          location: "Auditorium",
          attendees: 156,
          type: "Live Music",
        },
        {
          id: 3,
          title: "Coding Workshop: React Basics",
          category: "Academic",
          date: "Nov 23",
          time: "3:00 PM",
          location: "CS Lab",
          attendees: 45,
          type: "Workshop",
        },
        {
          id: 4,
          title: "Outdoor Hiking Trip",
          category: "Sports",
          date: "Nov 25",
          time: "9:00 AM",
          location: "Mountain Trail",
          attendees: 32,
          type: "Hiking",
        },
        {
          id: 5,
          title: "Sustainability Panel Discussion",
          category: "Academic",
          date: "Nov 26",
          time: "6:00 PM",
          location: "Hall B",
          attendees: 67,
          type: "Panel",
        },
        {
          id: 6,
          title: "Photography Walk & Share",
          category: "Social",
          date: "Nov 27",
          time: "5:00 PM",
          location: "Downtown",
          attendees: 18,
          type: "Photography",
        },
        {
          id: 7,
          title: "Food Truck Festival",
          category: "Social",
          date: "Nov 21",
          time: "12:00 PM",
          location: "Campus Lawn",
          attendees: 89,
          type: "Food",
        },
        {
          id: 8,
          title: "Machine Learning Seminar",
          category: "Academic",
          date: "Nov 24",
          time: "2:00 PM",
          location: "Tech Building",
          attendees: 38,
          type: "Seminar",
        },
        {
          id: 9,
          title: "Volleyball Tournament",
          category: "Sports",
          date: "Nov 28",
          time: "4:00 PM",
          location: "Sports Complex",
          attendees: 52,
          type: "Sports",
        },
        {
          id: 10,
          title: "Cultural Showcase - International Foods",
          category: "Cultural",
          date: "Nov 30",
          time: "6:30 PM",
          location: "Dining Hall",
          attendees: 112,
          type: "Cultural",
        },
        {
          id: 11,
          title: "Mental Health Wellness Workshop",
          category: "Wellness",
          date: "Nov 18",
          time: "5:00 PM",
          location: "Health Center",
          attendees: 43,
          type: "Workshop",
        },
        {
          id: 12,
          title: "Startup Pitch Competition",
          category: "Academic",
          date: "Dec 1",
          time: "7:00 PM",
          location: "Innovation Hub",
          attendees: 67,
          type: "Competition",
        },
      ];

      const interestGroups = [
        {
          id: 1,
          name: "Photography Club",
          members: 128,
          interests: "Photography, Visual Arts",
          active: true,
        },
        {
          id: 2,
          name: "Coding Club",
          members: 245,
          interests: "Programming, Web Dev",
          active: true,
        },
        {
          id: 3,
          name: "Outdoor Enthusiasts",
          members: 89,
          interests: "Hiking, Camping, Nature",
          active: true,
        },
        {
          id: 4,
          name: "Sustainability Alliance",
          members: 156,
          interests: "Environment, Social Good",
          active: true,
        },
        {
          id: 5,
          name: "Debate Team",
          members: 42,
          interests: "Public Speaking, Debate",
          active: true,
        },
        {
          id: 6,
          name: "Gaming Guild",
          members: 203,
          interests: "Video Games, Board Games",
          active: true,
        },
      ];

      let calendarDisplayMonth = new Date().getMonth();
      let calendarDisplayYear = new Date().getFullYear();

      window.previousMonth = function () {
        calendarDisplayMonth--;
        if (calendarDisplayMonth < 0) {
          calendarDisplayMonth = 11;
          calendarDisplayYear--;
        }
        window.viewEventCalendar();
      };

      window.nextMonth = function () {
        calendarDisplayMonth++;
        if (calendarDisplayMonth > 11) {
          calendarDisplayMonth = 0;
          calendarDisplayYear++;
        }
        window.viewEventCalendar();
      };

      window.viewEventCalendar = function () {
        const container = document.getElementById("eventContent");

        const today = new Date();
        const currentMonth = calendarDisplayMonth;
        const currentYear = calendarDisplayYear;
        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();

        const monthNames = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        const dayNames = [
          "Sunday",
          "Monday",
          "Tuesday",
          "Wednesday",
          "Thursday",
          "Friday",
          "Saturday",
        ];
        const dayAbbr = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

        // Map events to dates
        const eventsByDate = {};
        upcomingEvents.forEach((event) => {
          const dateParts = event.date.split(" ");
          const day = parseInt(dateParts[1]);
          if (!eventsByDate[day]) eventsByDate[day] = [];
          eventsByDate[day].push(event);
        });

        let html = `
        <div style="width: 100%; max-width: 1100px; margin: 0 auto; padding: 0 2rem;">
          <div style="background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 16px; padding: 2.5rem; margin-bottom: 3rem;">
            <div style="text-align: center; margin-bottom: 2.5rem;">
              <h3 style="color: #fff; margin: 0 0 1.5rem 0; font-size: 2rem; font-weight: 700;">${monthNames[currentMonth]} ${currentYear}</h3>
              <div style="display: flex; justify-content: center; gap: 1rem;">
                <button onclick="window.previousMonth()" style="padding: 0.8rem 1.5rem; background: rgba(139, 92, 246, 0.25); color: #c4b5fd; border: 1.5px solid rgba(139, 92, 246, 0.4); border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s ease;" onmouseover="this.style.background='rgba(139, 92, 246, 0.35)'; this.style.color='#e9d5ff'" onmouseout="this.style.background='rgba(139, 92, 246, 0.25)'; this.style.color='#c4b5fd'">‚Üê Previous Month</button>
                <button onclick="window.nextMonth()" style="padding: 0.8rem 1.5rem; background: rgba(139, 92, 246, 0.25); color: #c4b5fd; border: 1.5px solid rgba(139, 92, 246, 0.4); border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s ease;" onmouseover="this.style.background='rgba(139, 92, 246, 0.35)'; this.style.color='#e9d5ff'" onmouseout="this.style.background='rgba(139, 92, 246, 0.25)'; this.style.color='#c4b5fd'">Next Month ‚Üí</button>
              </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1rem; width: 100%;">
      `;

        // Day headers
        dayAbbr.forEach((day) => {
          html += `<div style="text-align: center; color: #a78bfa; font-weight: 700; padding: 1rem 0.5rem; border-bottom: 2px solid rgba(139, 92, 246, 0.3); font-size: 1rem;">${day}</div>`;
        });

        // Empty cells before month starts
        for (let i = 0; i < startingDayOfWeek; i++) {
          html += `<div style="aspect-ratio: 1; border-radius: 8px;"></div>`;
        }

        // Calendar days
        for (let day = 1; day <= daysInMonth; day++) {
          const isToday =
            day === today.getDate() && currentMonth === today.getMonth();
          const hasEvents = eventsByDate[day];
          const bgColor = isToday
            ? "rgba(139, 92, 246, 0.25)"
            : "rgba(255, 255, 255, 0.03)";
          const borderColor = isToday
            ? "2px solid #a78bfa"
            : "1px solid rgba(255, 255, 255, 0.1)";

          html += `
          <div style="aspect-ratio: 1; background: ${bgColor}; border: ${borderColor}; border-radius: 10px; padding: 0.75rem; cursor: pointer; display: flex; flex-direction: column; position: relative;" onmouseover="this.style.background='rgba(139, 92, 246, 0.2)'" onmouseout="this.style.background='${bgColor}'">
            <div style="font-weight: 700; color: ${isToday ? "#fbbf24" : "#cbd5e1"}; font-size: 1.1rem; margin-bottom: 0.5rem;">${day}</div>
        `;

          if (hasEvents) {
            html += `<div style="flex: 1; overflow: hidden;">`;
            hasEvents.forEach((event, idx) => {
              if (idx < 1) {
                const timeShort =
                  event.time.split(":")[0] + ":" + event.time.split(":")[1];
                html += `
                <div style="background: rgba(139, 92, 246, 0.5); padding: 0.35rem 0.4rem; border-radius: 4px; margin-bottom: 0.3rem; font-size: 0.65rem; color: #f3e8ff; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${event.title}">
                  ${timeShort}
                </div>
              `;
              }
            });
            if (hasEvents.length > 1) {
              html += `<div style="font-size: 0.65rem; color: #a78bfa; padding-top: 0.2rem;">+${hasEvents.length - 1}</div>`;
            }
            html += `</div>`;
          }

          html += `</div>`;
        }

        html += `
            </div>
          </div>
          
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
      `;

        // Show all events below calendar
        upcomingEvents.forEach((event) => {
          html += `
          <div style="background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 1.5rem; cursor: pointer;" onmouseover="this.style.background='rgba(255, 255, 255, 0.08)'" onmouseout="this.style.background='rgba(255, 255, 255, 0.05)'">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
              <div>
                <div style="font-size: 1.2rem; font-weight: 700; color: #fff;">${event.title}</div>
                <div style="font-size: 0.8rem; color: #94a3b8; margin-top: 0.3rem;">${event.type}</div>
              </div>
              <div style="background: rgba(139, 92, 246, 0.2); padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; color: #c4b5fd;">${event.category}</div>
            </div>
            <div style="border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 1rem; color: #cbd5e1; font-size: 0.9rem;">
              <div style="margin-bottom: 0.5rem;"><strong>Date:</strong> ${event.date} at ${event.time}</div>
              <div style="margin-bottom: 0.5rem;"><strong>Location:</strong> ${event.location}</div>
              <div style="margin-bottom: 1rem;"><strong>Going:</strong> ${event.attendees} people</div>
            </div>
            <button onclick="alert('RSVP feature coming soon!')" style="width: 100%; padding: 0.6rem; background: #8b5cf6; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">RSVP</button>
          </div>
        `;
        });

        html += `
          </div>
        </div>
      `;
        container.innerHTML = html;
      };

      window.createEvent = function () {
        const container = document.getElementById("eventContent");
        const html = `
        <div style="max-width: 600px; margin: 0 auto;">
          <div style="background: rgba(217, 70, 239, 0.1); border: 1px solid rgba(217, 70, 239, 0.2); border-radius: 12px; padding: 2rem;">
            <h3 style="color: #fff; margin-bottom: 1.5rem;">Create Your Event</h3>
            
            <div style="margin-bottom: 1rem;">
              <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Event Title</label>
              <input type="text" placeholder="What's your event about?" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 1rem;">
              <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Category</label>
              <select style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px;">
                <option value="">Select Category</option>
                <option value="social">Social</option>
                <option value="academic">Academic</option>
                <option value="cultural">Cultural</option>
                <option value="sports">Sports</option>
              </select>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
              <div>
                <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Date</label>
                <input type="date" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px; box-sizing: border-box;">
              </div>
              <div>
                <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Time</label>
                <input type="time" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px; box-sizing: border-box;">
              </div>
            </div>

            <div style="margin-bottom: 1rem;">
              <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Location</label>
              <input type="text" placeholder="Where will it be?" style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px; box-sizing: border-box;">
            </div>

            <div style="margin-bottom: 1rem;">
              <label style="display: block; color: #cbd5e1; margin-bottom: 0.5rem; font-weight: 600;">Description</label>
              <textarea placeholder="Tell people about your event..." style="width: 100%; padding: 0.75rem; background: rgba(15, 23, 42, 0.8); color: #fff; border: 1px solid rgba(217, 70, 239, 0.3); border-radius: 6px; box-sizing: border-box; height: 100px; resize: none;"></textarea>
            </div>

            <button onclick="alert('Event created! It will be live shortly.')" style="width: 100%; padding: 1rem; background: linear-gradient(135deg, #d946ef, #ec4899); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Publish Event</button>
          </div>
        </div>
      `;
        container.innerHTML = html;
      };

      window.viewEventGroups = function () {
        const container = document.getElementById("eventContent");
        let html = `
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem;">
      `;

        interestGroups.forEach((group) => {
          html += `
          <div style="background: rgba(8, 145, 178, 0.1); border: 1px solid rgba(8, 145, 178, 0.2); border-radius: 12px; padding: 1.5rem; cursor: pointer;" onmouseover="this.style.background='rgba(8, 145, 178, 0.15)'" onmouseout="this.style.background='rgba(8, 145, 178, 0.1)'">
            <div style="font-size: 1.3rem; font-weight: 700; color: #fff; margin-bottom: 0.5rem;">${group.name}</div>
            <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 1rem;">${group.interests}</div>
            <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid rgba(8, 145, 178, 0.2);">
              <div style="font-size: 0.85rem; color: #cbd5e1;"><strong>${group.members}</strong> members</div>
              <button onclick="alert('Joined group!')" style="padding: 0.5rem 1rem; background: #0891b2; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.85rem;">Join</button>
            </div>
          </div>
        `;
        });

        html += "</div>";
        container.innerHTML = html;
      };

      window.viewRecommended = function () {
        const container = document.getElementById("eventContent");
        let html = `
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem;">
      `;

        const recommended = upcomingEvents.slice(0, 3).reverse();

        recommended.forEach((event) => {
          const score = Math.floor(Math.random() * 30) + 70;
          html += `
          <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(249, 115, 22, 0.1)); border: 1px solid rgba(245, 158, 11, 0.2); border-radius: 12px; padding: 1.5rem; cursor: pointer;" onmouseover="this.style.background='linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(249, 115, 22, 0.15))'" onmouseout="this.style.background='linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(249, 115, 22, 0.1))'">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
              <div style="flex: 1;">
                <div style="font-size: 1.2rem; font-weight: 700; color: #fff;">${event.title}</div>
                <div style="font-size: 0.8rem; color: #94a3b8; margin-top: 0.3rem;">${event.type}</div>
              </div>
              <div style="text-align: center; background: rgba(245, 158, 11, 0.2); padding: 0.5rem 0.8rem; border-radius: 8px;">
                <div style="font-size: 1.2rem; font-weight: 700; color: #fbbf24;">${score}%</div>
                <div style="font-size: 0.7rem; color: #f59e0b;">Match</div>
              </div>
            </div>
            <div style="border-top: 1px solid rgba(245, 158, 11, 0.2); padding-top: 1rem; color: #cbd5e1; font-size: 0.9rem;">
              <div style="margin-bottom: 0.5rem;">${event.date} at ${event.time}</div>
              <div style="margin-bottom: 1rem;">${event.location}</div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                <button onclick="alert('RSVP feature coming soon!')" style="padding: 0.6rem; background: #f59e0b; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.85rem;">RSVP</button>
                <button onclick="alert('Saving event...')" style="padding: 0.6rem; background: rgba(245, 158, 11, 0.2); color: #fff; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.85rem;">Save</button>
              </div>
            </div>
          </div>
        `;
        });

        html += "</div>";
        container.innerHTML = html;
      };

      window.showResourceDetails = function (resource) {
        alert(
          "Resource details for: " +
            resource +
            " - Coming soon with full integration!"
        );
      };

      // Initial render
      renderTab(activeTab);
    </script>
    <script src="./js/animated-background.js"></script>
  </body>
</html>
